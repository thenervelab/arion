# Hippius Gateway example environment configuration
# Copy to .env (or wire into systemd/ansible) and adjust.

# Required / commonly configured
VALIDATOR_URL=http://validator:3002
PORT=3000
API_KEY_ADMIN=<set-a-strong-random-secret>

# Backpressure / download tuning (FetchBlob fanout)
# Global concurrency across all download requests (total in-flight FetchBlob tasks)
GATEWAY_GLOBAL_FETCH_CONCURRENCY=512
# Per-request concurrency (in-flight FetchBlob tasks for a single download request)
GATEWAY_REQUEST_FETCH_CONCURRENCY=64
# Max time to wait for a global permit before skipping a candidate (ms).
# 0 = wait indefinitely (recommended to prevent false "0 shards" failures under load)
GATEWAY_FETCH_PERMIT_TIMEOUT_MS=0
# Miner-control timeouts (secs)
GATEWAY_FETCH_CONNECT_TIMEOUT_SECS=20
GATEWAY_FETCH_READ_TIMEOUT_SECS=15

# Optional: auto repair-hints (gateway -> validator) when a stripe can't be reconstructed.
# This does NOT give gateway miner-control; it only asks validator to enqueue a bounded repair job.
GATEWAY_AUTO_REPAIR_HINT_ENABLED=true
GATEWAY_REPAIR_HINT_MIN_INTERVAL_SECS=600
GATEWAY_REPAIR_HINT_COUNT=2
# Expensive; enable only for stranded legacy files when epoch history is missing
GATEWAY_REPAIR_HINT_ALLOW_SCAN=false

# Auth for validator /repair_hint endpoint
VALIDATOR_GATEWAY_KEY=<set-a-strong-random-secret>

